# 2014-09-10　Vimの壁(1)

vimを使い始めて0.75年くらいたち、やっと業務でもなんとか使えるレベルの練度となってきた(※1)。
いくらVimがみんなが裸足で逃げ出すテキストエディタと言われようと、それはなんでもかかり過ぎだったように思う。

このVim日記、誰の役にも立たないのも忍びないので、もしVim使ってみたいという人が裸足で逃げ出さないために、
今今時点でこうしておけばよかったと感じて後悔している、より早く手になじませるために抑えておくべきポイントを記したいと思う。

## 操作編

### hjklによるカーソル移動は後でいい 

vi,vimといえば、カーソルキーを使わないカーソル移動が思い浮かぶかもしれない。
チュートリアルをはじめ、vimのイロハを書いたページには必ず先頭にくる機能だ。
だが、これはvimの機能の本質ではないし、ましてや一番最初に覚えるべきことでもない。

カーソルキーでもカーソルは動く。今までのやり方でできることは、後からで構わない。

### ノーマルモードのカーソルがなぜ四角いか、を知る 

ノーマルモードのカーソルは通常のエディタの字と字の間に線で表示されるものと異なり、四角い。文字一つにかぶさる形でポイントされる。
これは、その文字が選択状態にあることに加えて、挿入モードに入る際に、その文字の前後どちらにも入れることを示す。

大抵のクイックなチュートリアルやイロハのページには、挿入モードへの入り方はiキーを押せ、という1パターンしか書いておらず、そのほかは後で覚えろ、というような書き方をしているが、このことを知っておかないといつまでも四角いカーソルの謎に悩まされる。

### 挿入モードへの入り方を早い段階で出来るだけ多く知っておく

前項の話の流れだが、挿入モードへの入り方はiキーを押すだけではない。
Vimを覚える上で、一番避けなければいけない状態が、この挿入モードへの入り方をiキーを使う1通りしか知らないという状態だ。
なぜなら、iキーはノーマルモードの四角いカーソルの手前側に挿入カーソルをポイントして挿入モードに移行する。この場合、行の最終文字の後ろに入ることが出来ない。つまりこの場合、一番汎用的な編集であろう「行の最後から書き足したい」、というときに、一番後ろまでカーソルを移動して、iを押して、カーソルキーで→しなければならないという、
最悪極まりなく非効率な状態に陥る。

* i / カーソルの手前で挿入モード移行
* a / カーソルの後ろで挿入モード移行
* I / カーソルのある行の先頭に移動して挿入モード移行
* A / カーソルのある行の終端に移動して挿入モード移行
* o / カーソルのある行の下に改行を入れつつ、その行に移動して挿入モード移行
* O / カーソルのある行の上に改行を入れつつ、その行に移動して挿入モード移行
* s / カーソルの文字を削除しつつ、その位置で挿入モード移行
* S / カーソルの行を削除しつつ、その位置で挿入モード移行

上記を出来るだけ早く覚えることで、ノーマルモードと挿入モードの移行が苦でなくなり、
果てはモードレスなテキストエディタより効率的であると思えるようになる。

## 機能編

### 便利さ、速さの片鱗を早いうちに味わう 
なぜVimは便利なのか、なぜVimは速いのか、それを早いうちに理解することが大切だ。だが、そういった切り口のチュートリアルはほとんどない。ただ「どうやって操作するか」についてばかり記述されている。なので、操作の記述のなかで、Vim独特の機能を探していくと良い。モードレスなテキストエディタと同じことをしようとすると覚えるコストだけが先に立ち、恩恵がない。先にVimでしか出来ないこと、Vimでなければ圧倒的な効率を実現できないことから覚え、最初は使い慣れたエディタと行き来しつつ、少しずつ同等の機能も覚えていくのが、挫折しない一つのやり方であると思う。

### 行単位での編集を覚える 

行単位の編集が非常に効率的であり、それが独立した機能として割り当てられていることはVimの大きな特徴である。
これを知っておくだけでもVimの諸々を覚えるコストに見合うと思えるようになるかもしれない。

* yy / カーソル位置の行をヤンク(コピー)
* dd / カーソル位置の行を削除
* V / 行選択ビジュアルモード移行

--- 

2に続く。

---

※1 最近はIDEと並行して立ち上げておき、主なソースの編集はVimで、統合的な操作はIDEで、というような使い分けをしている。
