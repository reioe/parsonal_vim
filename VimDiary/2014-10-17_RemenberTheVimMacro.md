# 2014-10-17 VimMacroを忘れない

VimのMacroが超絶的に効果的だった場面に遭遇したので、これはもっと使っていかなければならないと思った次第。
よくコマンドを忘れるので、書いて覚えて備忘とする。


## ごく基本的なマクロの手順

* マクロ記録開始

``` VimCommand
qa
```
qでマクロ起動、aは任意の文字キーで、マクロを記録するレジスタとなる。


* マクロ記録

ステータス部分に"マクロ記録中"と出るので、ももりもりきろく。


* マクロ記録終了

``` VimCommand
q

```
* マクロ起動

``` VimCommand
@a

```
aはレジスタの文字キー。


## 今回遭遇した効果的場面

1. SQLでINSERT文100レコード分作る。
2. インデックス列(一意制約のある連番にすべき整数)を有する
3. 他の列はNULLまたは列ごと同じ値で良い

というような条件。

* 行ヤンク&ペースト
* インデックス値のインクリメント

だけで簡単に1回分は記録できる。

コレだったらサクラエディタなんかでも出来そうなものだが(※2)、
Vimの特徴として、ほぼすべてのコマンドには引数として繰り返し数を設定できる。

そのため…

``` VimCommand
50@a
```

で50回分回して50レコード分INSERT文が生成される。(※2)

![increment_macro_result](./Images/increment_macro_result.jpg)


超！絶！便！利！

---

※1 サクラエディタにはインクリメントの機能がなかった。Vimの一人勝ちだ！
※2 行ヤンクペーストでカーソルが左端に寄ることや、カーソルはwキーでn単語分の移動とするなどマクロ中の字数変化にうまく追従するギミックが揃っている。
